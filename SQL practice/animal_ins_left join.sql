DROP DATABASE IF EXISTS c2;
CREATE DATABASE c2;
USE c2;

CREATE TABLE ANIMAL_INS(
ANIMAL_ID	VARCHAR(60)	NOT NULL,
ANIMAL_TYPE	VARCHAR(60)	NOT NULL,
`DATETIME`	DATETIME	NOT NULL,
INTAKE_CONDITION	VARCHAR(60)	NOT NULL,
`NAME`	VARCHAR(60),
SEX_UPON_INTAKE	VARCHAR(60)	NOT NULL
);

CREATE TABLE ANIMAL_OUTS(
ANIMAL_ID	VARCHAR(60)	NOT NULL,
ANIMAL_TYPE	VARCHAR(60)	NOT NULL,
`DATETIME`	DATETIME	NOT NULL,
`NAME`	VARCHAR(60)	,
SEX_UPON_OUTCOME	VARCHAR(60)	NOT NULL
);

INSERT INTO ANIMAL_INS VALUES('A354597','Cat','2014-05-02 12:16:00','Normal','Ariel','Spayed Female');
INSERT INTO ANIMAL_INS VALUES('A373687','Dog','2014-03-20 12:31:00','Normal','Rosie','Spayed Female');
INSERT INTO ANIMAL_INS VALUES('A412697','Dog','2016-01-03 16:25:00','Normal','Jackie','Neutered Male');
INSERT INTO ANIMAL_INS VALUES('A413789','Dog','2016-04-19 13:28:00','Normal','Benji','Spayed Female');
INSERT INTO ANIMAL_INS VALUES('A414198','Dog','2015-01-29 15:01:00','Normal','Shelly','Spayed Female');
INSERT INTO ANIMAL_INS VALUES('A368930','Dog','2014-06-08 13:20:00','Normal', NULL,'Spayed Female');

SELECT *
FROM ANIMAL_INS;


INSERT INTO ANIMAL_OUTS VALUES('A354597','Cat','2014-05-02 12:16:00','Ariel','Spayed Female');
INSERT INTO ANIMAL_OUTS VALUES('A373687','Dog','2014-03-20 12:31:00','Rosie','Spayed Female');
INSERT INTO ANIMAL_OUTS VALUES('A368930','Dog','2014-06-08 13:20:00', NULL,'Spayed Female');

SELECT *
FROM ANIMAL_OUTS;

# 두 테이블에 포함되어 있는 녀석들 즉 입양간 녀석들 
SELECT ANIMAL_INS.`NAME`AS `NAME`, ANIMAL_INS.`DATETIME` AS `DATETIME`
FROM ANIMAL_INS
INNER JOIN ANIMAL_OUTS
ON ANIMAL_INS.ANIMAL_ID = ANIMAL_OUTS.ANIMAL_ID
ORDER BY `DATETIME` ASC
LIMIT 3



#하지만 우리가 알아야 하는 것은 ANIMAL_INS  테이블엔 포함되어 있으면서 ANIMAL_OUTS 에 포합되지 않는 녀석들

#https://chlgpdus921.github.io/basecamp/MySQL-JOIN/


SELECT ANIMAL_INS.`NAME`AS `NAME`, ANIMAL_INS.`DATETIME` AS `DATETIME`
SELECT *
FROM ANIMAL_INS
LEFT JOIN ANIMAL_OUTS
ON ANIMAL_INS.ANIMAL_ID = ANIMAL_OUTS.ANIMAL_ID
WHERE ANIMAL_OUTS.ANIMAL_ID IS NULL
ORDER BY `DATETIME` ASC
LIMIT 3
